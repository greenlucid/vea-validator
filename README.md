# VEA Validator

Rust validator for the VEA cross-chain messaging protocol (Arbitrum ↔ Ethereum).

## Quick Start

```bash
# Install dependencies (Rust & Foundry)
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
curl -L https://foundry.paradigm.xyz | bash && foundryup

# Fetch contracts & start local devnet with deployed contracts
./scripts/fetch-vea-contracts.sh
./scripts/full-devnet.sh

# Run tests
cargo test

# Run validator (local devnet)
cargo run
```

## Project Structure

```
├── src/                # Rust validator
├── tests/              # Rust validator tests
├── contracts/          # VEA contracts (fetched)
├── scripts/            # Setup scripts
└── info/               # Internal docs
```

## Running the Validator

### Local Development (Devnet)

```bash
# Start local devnet (in separate terminal)
./scripts/full-devnet.sh

# Run validator
cargo run
```

### Testnet Deployment

1. **Setup Configuration**
   ```bash
   cp .env.example .env.testnet
   # Edit .env.testnet with testnet RPC endpoints and contract addresses
   ```

2. **Set Private Key** (NEVER commit!)
   ```bash
   export PRIVATE_KEY=your_testnet_private_key_without_0x
   ```

3. **Run Validator**
   ```bash
   source .env.testnet
   cargo run
   ```

## Configuration

### Environment Files

- `.env` or `.env.local` - Auto-generated by `full-devnet.sh` for local development
- `.env.testnet` - Testnet configuration (e.g., Arbitrum Sepolia → Ethereum Sepolia)
- `.env.production` - Production/mainnet configuration
- `.env.example` - Template with all available options

### Required Environment Variables

- `ARBITRUM_RPC_URL` - Arbitrum chain RPC endpoint
- `ETHEREUM_RPC_URL` - Ethereum chain RPC endpoint  
- `VEA_INBOX_ARB_TO_ETH` - VeaInbox contract address on Arbitrum
- `VEA_OUTBOX_ARB_TO_ETH` - VeaOutbox contract address on Ethereum
- `PRIVATE_KEY` - Validator wallet private key (provided separately, never in .env files)

### Key Management

**NEVER commit private keys!** Options for secure key management:

1. **Environment Variable** (development)
   ```bash
   export PRIVATE_KEY=xxx
   cargo run
   ```

2. **External KMS** (recommended for production)
   - AWS KMS, Google Cloud KMS, HashiCorp Vault
   - Hardware wallets (Ledger, Trezor)

## Testnet Information

### Contract Addresses (Sepolia)

**Arbitrum Sepolia:**
- VeaInbox: `0xAA4F00c86bf956C0Fae603D030CBc2dA7f8B7C5B`

**Ethereum Sepolia:**
- VeaOutbox: `0xC0574e973059e727E5E4bEB2e04F1D69F627faab`

### RPC Endpoints

**Public endpoints:**
- Arbitrum Sepolia: `https://sepolia-rollup.arbitrum.io/rpc`
- Ethereum Sepolia: `https://rpc.sepolia.org`

**Provider endpoints (requires API key):**
- Alchemy: `https://arb-sepolia.g.alchemy.com/v2/{YOUR_KEY}`
- Infura: `https://sepolia.infura.io/v3/{YOUR_KEY}`

### Testnet Faucets

- [Arbitrum Sepolia Faucet](https://faucets.chain.link/arbitrum-sepolia)
- [Ethereum Sepolia Faucet](https://sepoliafaucet.com/)

## Scripts

- `fetch-vea-contracts.sh` - Downloads VEA contracts from GitHub
- `full-devnet.sh` - Starts local devnet + deploys all contracts
- `run-validator.sh` - Runs validator with specified network config

## Development

```bash
# Build
cargo build --release

# Run tests
cargo test

# Run with logs
RUST_LOG=debug cargo run
```

## License

MIT